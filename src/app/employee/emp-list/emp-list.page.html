<ion-header>
  <ion-toolbar>
    <ion-title class="emp-title">Employee Management</ion-title>
    <ion-icon class="emp-list-new"
              id="emp-add-new"
              name="add-circle-outline"
              (click)="empAdd('add')"></ion-icon>
    <!-- filter -->
    <ion-icon class="emp-list-filter"
              name="search-outline"
              id="emp-filter"></ion-icon>
    <ion-icon class="emp-list-clear"
              name="close-outline"
              (click)="clearFilter()"></ion-icon>
    <ion-modal trigger="emp-filter">
      <ng-template class="emp-filter-template">
        <ion-header>
          <ion-toolbar>
            <ion-title class="emp-title">Employee Search</ion-title>
          </ion-toolbar>
        </ion-header>
        <ion-content class="emp-filter-content">
          <form class="emp-filter-form"
                [formGroup]="ionicSearchForm"
                (ngSubmit)="submitSearchForm()"
                novalidate>
            <!-- Employee Name -->
            <ion-item>
              <ion-label class="required"
                         position="floating">Employee Name</ion-label>
              <ion-input formControlName="name"
                         maxlength="12"
                         type="text"></ion-input>
            </ion-item>
            <span class="error ion-padding"
                  *ngIf="isSubmitted && errorControl.name.errors?.required">
              Name is required.
            </span>
            <!-- Department Name -->
            <ion-item class="search-type">
              <ion-label position="floating"
                         class="required">Department Name</ion-label>
              <ion-select interface="popover"
                          formControlName="department">
                <ion-select-option *ngFor="let department of departments; let i = index;"
                                   value="{{department}}">{{department}}</ion-select-option>
              </ion-select>
            </ion-item>
            <span class="error ion-padding"
                  *ngIf="isSubmitted && errorControl.department.errors?.required">
              Department is required.
            </span>
            <ion-item id="dob-modal">
              <ion-label>Dob</ion-label>
              <ion-text slot="end">
                {{formattedString | date: 'dd/MM/YYYY'}}
              </ion-text>
              <ion-icon icon="calendar-outline"
                        slot="end"></ion-icon>
            </ion-item>
            <ion-modal trigger="dob-modal"
                       class="dob-modal">
              <ng-template>
                <ion-content>
                  <ion-datetime #datetime
                                locale="en-GB-u-hc-h12"
                                formControlName="dob"
                                displayFormat="dd/MM/YYYY"
                                size="cover"
                                (ionChange)="getDate(datetime.value)"
                                (ionCancel)="showPicker = false;">
                    <ion-buttons slot="buttons">
                      <ion-button (click)="close()">Dismiss</ion-button>
                      <ion-button (click)="select()"
                                  color='primary'>Select</ion-button>
                    </ion-buttons>
                  </ion-datetime>
                </ion-content>
              </ng-template>
            </ion-modal>
            <!-- Position -->
            <ion-item class="search-type">
              <ion-label position="floating"
                         class="required">Position</ion-label>
              <ion-select interface="popover"
                          formControlName="position">
                <ion-select-option *ngFor="let position of positions; let i = index;"
                                   value="{{position}}">{{position}}</ion-select-option>
              </ion-select>
            </ion-item>
            <span class="error ion-padding"
                  *ngIf="isSubmitted && errorControl.position.errors?.required">
              Position is required.
            </span>
            <!-- NRC -->
            <ion-item lines="full">
              <ion-label position="floating">NRC</ion-label>
              <ion-input formControlName="nrc"
                         maxlength="12"
                         type="text"></ion-input>
            </ion-item>
            <!-- Salary -->
            <ion-item lines="full">
              <ion-label position="floating">Salary</ion-label>
              <ion-input formControlName="salary"
                         maxlength="28"
                         [(ngModel)]="salary"
                         (keyup)="formatInput()"
                         type="text"></ion-input>
            </ion-item>
            <!-- Operation -->
            <ion-row class="filter-operation-row">
              <ion-col class="filter-operation-col">
                <ion-button class="filter-margin"
                            (click)="cancelSearch()"
                            color="danger">Cancel</ion-button>
                <ion-button type="submit"
                            color="success"
                            class="filter-margin search-btn">Search</ion-button>
              </ion-col>
            </ion-row>
          </form>
        </ion-content>
      </ng-template>
    </ion-modal>
  </ion-toolbar>
</ion-header>
<ion-content>
  <!-- pager limit -->
  <div class="pagination-select-box">
    <ion-label class="pagination-label">Pages</ion-label>
    <ion-select name="pageLimit"
                class="pager-limit"
                interface="popover"
                #pageLimit="ngModel"
                [(ngModel)]="perPage"
                (ionChange)="selectionChange()">
      <ion-select-option *ngFor="let perPage of [10, 20, 30]"
                         [value]="perPage">
        {{ perPage }}
      </ion-select-option>
    </ion-select>
  </div>
  <!-- employee list -->
  <ion-list>
    <ion-item *ngFor="let emp of itemsToDisplay; let i = index;">
      <ion-card class="emp-data-card">
        <ion-card-content class="emp-data-info">
          <ion-label class="emp-list-profile">Employee Name: {{emp.emp_name}}</ion-label><br>
          <ion-label class="emp-list-profile">Department: {{emp.department}}</ion-label><br>
          <ion-label class="emp-list-profile">DOB: {{emp.dob | date:'dd/MM/YYYY'}}</ion-label><br>
          <ion-label class="emp-list-profile">Position: {{emp.position}}</ion-label><br>
          <ion-label class="emp-list-profile">NRC: {{emp.nrc}}</ion-label><br>
          <ion-label class="emp-list-profile">Salary: {{emp.salary| number: '1.2-2'}}</ion-label><br>
        </ion-card-content>
        <ion-card-content class="emp-data-operation">
          <ion-icon class="emp-edit-icon"
                    id="emp-edit"
                    name="pencil-outline"
                    (click)="empEdit('edit', emp.id)"></ion-icon>
          <ion-icon class="emp-delete-icon"
                    (click)="confirmDeleteEmployee(emp.id)"
                    name="trash-bin-outline"></ion-icon>
        </ion-card-content>
      </ion-card>
    </ion-item>
    <ion-title class="error-msg"
               *ngIf="itemsToDisplay.length === 0">There is no employee data.</ion-title>
  </ion-list>
  <!-- pager -->
  <app-pagination *ngIf="itemsToDisplay.length !== 0"
                  [current]="current"
                  [total]="total"
                  (goTo)="onGoTo($event)"
                  (next)="onNext($event)"
                  (previous)="onPrevious($event)"></app-pagination>
</ion-content>